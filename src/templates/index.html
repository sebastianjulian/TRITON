<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TRITON - Autonomous Submarine Navigation System</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      /* Dark Ocean (Default) */
      --bg-primary: #0a1520;
      --bg-secondary: #1a2a3a;
      --bg-tertiary: #0f1f2f;
      --bg-card: #1c2d3e;
      --bg-header: #162535;
      --color-primary: #00aaff;
      --color-secondary: #0088cc;
      --color-accent: #0066aa;
      --color-text-primary: #ffffff;
      --color-text-secondary: #e0ebf5;
      --color-text-muted: #b0c4d8;
      --color-border: #2d4155;
      --color-border-accent: #00aaff;
      --glow-primary: 0 0 20px rgba(0, 170, 255, 0.3);
      --glow-accent: 0 0 15px rgba(0, 102, 170, 0.2);
      --gradient-bg: linear-gradient(135deg, #0a1520 0%, #1a2a3a 100%);
      --gradient-card: linear-gradient(145deg, #1c2d3e 0%, #2d4155 100%);
    }
    
    
    [data-theme="night"] {
      --bg-primary: #0f172a;
      --bg-secondary: #1e293b;
      --bg-tertiary: #334155;
      --bg-card: #1e293b;
      --bg-header: #0f172a;
      --color-primary: #f59e0b;
      --color-secondary: #d97706;
      --color-accent: #f59e0b;
      --color-text-primary: #f8fafc;
      --color-text-secondary: #e2e8f0;
      --color-text-muted: #94a3b8;
      --color-border: #475569;
      --color-border-accent: #f59e0b;
      --glow-primary: 0 0 20px rgba(245, 158, 11, 0.3);
      --glow-accent: 0 0 15px rgba(217, 119, 6, 0.2);
      --gradient-bg: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      --gradient-card: linear-gradient(145deg, #1e293b 0%, #334155 100%);
    }
    
    [data-theme="light-ocean"] {
      --bg-primary: #c2e7f7;
      --bg-secondary: #92d4ef;
      --bg-tertiary: #68c1e7;
      --bg-card: #a8dcf4;
      --bg-header: #7ac6eb;
      --color-primary: #0ea5e9;
      --color-secondary: #0284c7;
      --color-accent: #0369a1;
      --color-text-primary: #032436;
      --color-text-secondary: #05314a;
      --color-text-muted: #094358;
      --color-border: #5fb0db;
      --color-border-accent: #0ea5e9;
      --glow-primary: 0 0 20px rgba(14, 165, 233, 0.4);
      --glow-accent: 0 0 16px rgba(3, 105, 161, 0.3);
      --gradient-bg: linear-gradient(135deg, #c2e7f7 0%, #92d4ef 35%, #68c1e7 70%, #4fb6e3 100%);
      --gradient-card: linear-gradient(145deg, #a8dcf4 0%, #7ac6eb 40%, #5fb0db 80%, #4ba3d1 100%);
    }

    [data-theme="nature"] {
      /* Nature - Earthy greens and browns (High Contrast) */
      --bg-primary: #0d1a0d;
      --bg-secondary: #1a2e1a;
      --bg-tertiary: #142414;
      --bg-card: #1f3a1f;
      --bg-header: #142414;
      --color-primary: #5eff8a;
      --color-secondary: #2edd62;
      --color-accent: #98ffb8;
      --color-chart: #3cb371;
      --color-text-primary: #ffffff;
      --color-text-secondary: #d0ffd8;
      --color-text-muted: #7abf8a;
      --color-border: #2d5a2d;
      --color-border-accent: #5eff8a;
      --glow-primary: 0 0 25px rgba(94, 255, 138, 0.4);
      --glow-accent: 0 0 18px rgba(46, 221, 98, 0.3);
      --gradient-bg: linear-gradient(135deg, #0d1a0d 0%, #1a2e1a 50%, #0d1a0d 100%);
      --gradient-card: linear-gradient(145deg, #1f3a1f 0%, #2d5a2d 100%);
    }

    [data-theme="retro"] {
      /* Retro - 80s Synthwave/Neon (High Contrast) */
      --bg-primary: #0d0518;
      --bg-secondary: #1a0a2e;
      --bg-tertiary: #140a24;
      --bg-card: #2a1048;
      --bg-header: #140a24;
      --color-primary: #ff33ff;
      --color-secondary: #33ffff;
      --color-accent: #ff85d5;
      --color-chart: #cc66cc;
      --color-text-primary: #ffffff;
      --color-text-secondary: #ffe6fc;
      --color-text-muted: #d4a8e0;
      --color-border: #5a2088;
      --color-border-accent: #ff33ff;
      --glow-primary: 0 0 30px rgba(255, 51, 255, 0.6);
      --glow-accent: 0 0 25px rgba(51, 255, 255, 0.5);
      --gradient-bg: linear-gradient(135deg, #0d0518 0%, #1a0a2e 50%, #0d0518 100%);
      --gradient-card: linear-gradient(145deg, #2a1048 0%, #3d1868 50%, #2a1048 100%);
    }

    [data-theme="futuristic"] {
      /* Futuristic - Cyberpunk/Tech (High Contrast) */
      --bg-primary: #050508;
      --bg-secondary: #0a0a10;
      --bg-tertiary: #08080c;
      --bg-card: #0f0f18;
      --bg-header: #08080c;
      --color-primary: #00ffff;
      --color-secondary: #9945ff;
      --color-accent: #ff3377;
      --color-chart: #00b8b8;
      --color-text-primary: #ffffff;
      --color-text-secondary: #c0f8ff;
      --color-text-muted: #5599aa;
      --color-border: #1a1a2e;
      --color-border-accent: #00ffff;
      --glow-primary: 0 0 35px rgba(0, 255, 255, 0.5);
      --glow-accent: 0 0 25px rgba(153, 69, 255, 0.4);
      --gradient-bg: linear-gradient(135deg, #050508 0%, #0a0a10 50%, #050508 100%);
      --gradient-card: linear-gradient(145deg, #0f0f18 0%, #14142a 50%, #0f0f18 100%);
    }


    
    
    
    
    * {
      transition: color 0.4s ease, background-color 0.4s ease, border-color 0.4s ease, box-shadow 0.4s ease, background 0.4s ease;
    }

    /* Theme transition animations */
    :root {
      transition: all 0.4s ease;
    }
    
    body, header, section, .card, .chart-box {
      transition: background 0.4s ease, color 0.4s ease, border-color 0.4s ease, box-shadow 0.4s ease;
    }

    body {
      margin: 0;
      padding: 0;
      background: var(--gradient-bg);
      color: var(--color-text-primary);
      font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      line-height: 1.6;
      min-height: 100vh;
      position: relative;
    }
    
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 25% 25%, var(--color-primary)10, transparent 50%),
                  radial-gradient(circle at 75% 75%, var(--color-accent)08, transparent 50%);
      pointer-events: none;
      z-index: -1;
    }

    header {
      background: var(--bg-header);
      padding: 50px 20px 15px 20px;
      text-align: center;
      border-bottom: 2px solid var(--color-border-accent);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
      position: relative;
    }

    .header-nav {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: rgba(22, 37, 53, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--color-border);
      padding: 10px 0;
      z-index: 10000;
      transition: all 0.3s ease;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      display: block;
      visibility: visible;
      overflow: visible;
    }

    .header-nav.scrolled {
      background: rgba(22, 37, 53, 0.98);
      box-shadow: 0 2px 15px rgba(0, 0, 0, 0.5);
    }

    /* Theme-specific navigation backgrounds */
    [data-theme="night"] .header-nav {
      background: rgba(15, 23, 42, 0.95);
    }

    [data-theme="night"] .header-nav.scrolled {
      background: rgba(15, 23, 42, 0.98);
    }

    [data-theme="light-ocean"] .header-nav {
      background: rgba(122, 198, 235, 0.95);
    }

    [data-theme="light-ocean"] .header-nav.scrolled {
      background: rgba(122, 198, 235, 0.98);
    }

    [data-theme="nature"] .header-nav {
      background: rgba(20, 36, 20, 0.95);
    }

    [data-theme="nature"] .header-nav.scrolled {
      background: rgba(20, 36, 20, 0.98);
    }

    [data-theme="retro"] .header-nav {
      background: rgba(20, 10, 36, 0.95);
    }

    [data-theme="retro"] .header-nav.scrolled {
      background: rgba(20, 10, 36, 0.98);
    }

    [data-theme="futuristic"] .header-nav {
      background: rgba(8, 8, 12, 0.95);
    }

    [data-theme="futuristic"] .header-nav.scrolled {
      background: rgba(8, 8, 12, 0.98);
    }

    .main-nav {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      flex-wrap: wrap;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
      overflow: visible;
    }

    .main-nav a {
      color: var(--color-text-secondary);
      text-decoration: none;
      font-weight: 500;
      font-size: 0.9em;
      padding: 8px 12px;
      border-radius: 6px;
      transition: all 0.3s ease;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid transparent;
      backdrop-filter: blur(10px);
      white-space: nowrap;
    }

    .main-nav a:hover {
      color: var(--color-primary);
      background: var(--bg-card);
      border-color: var(--color-primary);
      box-shadow: var(--glow-primary);
      transform: translateY(-2px);
    }

    .main-nav a[target="_blank"] {
      background: var(--color-primary);
      color: var(--bg-primary);
      font-weight: 600;
    }

    .main-nav a[target="_blank"]:hover {
      background: var(--color-accent);
      color: var(--bg-primary);
    }
    
    header::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--color-primary), transparent);
      box-shadow: var(--glow-primary);
    }

    header h1 {
      margin: 35px 0 0 0;
      font-size: 2em;
      color: var(--color-text-primary);
      font-weight: 700;
      letter-spacing: 0.1em;
      text-shadow: var(--glow-primary);
      position: relative;
    }

    header .subtitle {
      margin: 3px 0 0 0;
      font-size: 0.95em;
      color: var(--color-primary);
      font-weight: 300;
      text-shadow: var(--glow-accent);
    }

    .container {
      max-width: 1600px;
      margin: 0 auto;
      padding: 0 30px;
    }

    section {
      padding: 15px 0;
      position: relative;
      z-index: 1;
    }

    h2 {
      color: var(--color-text-primary);
      font-size: 1.3em;
      margin-bottom: 10px;
      border-left: 3px solid var(--color-primary);
      padding-left: 12px;
      text-shadow: var(--glow-accent);
      position: relative;
    }

    h2::before {
      content: '';
      position: absolute;
      left: -3px;
      top: 0;
      width: 3px;
      height: 100%;
      background: var(--color-primary);
      box-shadow: var(--glow-primary);
    }

    h3 {
      color: var(--color-text-primary);
      font-size: 1.1em;
      margin-top: 15px;
      margin-bottom: 8px;
      font-weight: 600;
    }

    p {
      color: var(--color-text-secondary);
      font-size: 0.9em;
      margin-bottom: 10px;
      text-align: justify;
      line-height: 1.5;
    }

    .hero-section {
      background: var(--gradient-card);
      padding: 20px 0;
      text-align: center;
      position: relative;
      overflow: hidden;
      z-index: 1;
    }

    .hero-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at center, var(--color-primary)08, transparent 70%);
      pointer-events: none;
    }

    .hero-content {
      max-width: 1400px;
      margin: 0 auto;
    }

    .hero-description {
      font-size: 1em;
      color: var(--color-text-muted);
      margin: 10px 0 15px 0;
      line-height: 1.5;
      font-weight: 400;
    }

    .cta-button {
      display: inline-block;
      background: var(--color-primary);
      color: var(--bg-primary);
      padding: 10px 25px;
      font-size: 1em;
      font-weight: 600;
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.3s ease;
      margin: 8px;
      box-shadow: var(--glow-primary), 0 4px 15px rgba(0, 0, 0, 0.3);
      border: 1px solid var(--color-primary);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }

    .cta-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .cta-button:hover {
      background: var(--color-accent);
      color: var(--bg-primary);
      transform: translateY(-2px);
      box-shadow: var(--glow-accent), 0 6px 20px rgba(0, 0, 0, 0.4);
    }

    .cta-button:hover::before {
      left: 100%;
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 12px;
      margin: 15px 0;
    }

    .feature-card {
      background: var(--gradient-card);
      padding: 14px;
      border-radius: 10px;
      border: 1px solid var(--color-border);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .feature-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at top left, var(--color-primary)05, transparent 50%);
      pointer-events: none;
    }
    
    .feature-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 35px rgba(0, 0, 0, 0.5), var(--glow-primary);
      border-color: var(--color-primary);
    }

    .feature-card h4 {
      color: var(--color-primary);
      font-size: 0.95em;
      margin-bottom: 6px;
      font-weight: 600;
      text-shadow: var(--glow-accent);
    }

    .feature-card p {
      color: var(--color-text-muted);
      margin-bottom: 0;
      text-align: left;
      line-height: 1.4;
      font-size: 0.8em;
    }

    .tech-specs {
      background: var(--gradient-card);
      padding: 18px;
      border-radius: 10px;
      margin: 15px 0;
      border: 1px solid var(--color-border);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      position: relative;
    }

    .tech-specs::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at center, var(--color-primary)03, transparent 70%);
      pointer-events: none;
    }

    .specs-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 8px;
      margin-top: 10px;
    }

    .spec-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 10px;
      background: var(--bg-card);
      border-radius: 6px;
      border-left: 3px solid var(--color-primary);
      min-height: 30px;
      gap: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      position: relative;
    }

    .spec-item::before {
      content: '';
      position: absolute;
      left: -3px;
      top: 0;
      width: 3px;
      height: 100%;
      background: var(--color-primary);
      box-shadow: var(--glow-primary);
      border-radius: 0 2px 2px 0;
    }

    .spec-item:hover {
      background: var(--bg-tertiary);
      box-shadow: 0 3px 12px rgba(0, 0, 0, 0.3), var(--glow-accent);
    }

    .spec-label {
      font-weight: 600;
      color: var(--color-text-primary);
      min-width: 80px;
      flex-shrink: 0;
      font-size: 0.8em;
      line-height: 1.3;
    }

    .spec-value {
      color: var(--color-primary);
      font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
      text-align: right;
      flex: 1;
      font-size: 0.8em;
      line-height: 1.3;
      max-width: 60%;
      font-weight: 500;
      text-shadow: var(--glow-accent);
    }

    .mission-overview {
      text-align: center;
      padding: 20px 0;
      background: var(--gradient-card);
      position: relative;
      overflow: hidden;
    }

    .mission-overview .container {
      margin-bottom: 15px;
    }

    .mission-overview::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(ellipse at center, var(--color-accent)05, transparent 70%);
      pointer-events: none;
    }

    .data-flow {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 15px auto;
      flex-wrap: wrap;
      gap: 10px;
      max-width: 1600px;
      padding: 0 20px;
    }

    .flow-step {
      background: var(--gradient-card);
      padding: 12px;
      border-radius: 8px;
      text-align: center;
      flex: 1;
      min-width: 140px;
      border: 1px solid var(--color-primary);
      box-shadow: var(--glow-primary), 0 3px 10px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .flow-step::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at center, var(--color-primary)08, transparent 60%);
      pointer-events: none;
    }

    .flow-step:hover {
      transform: translateY(-2px);
      box-shadow: var(--glow-accent), 0 5px 15px rgba(0, 0, 0, 0.4);
    }

    .flow-arrow {
      font-size: 1.3em;
      color: var(--color-primary);
      margin: 0 5px;
      text-shadow: var(--glow-primary);
      filter: drop-shadow(var(--glow-primary));
    }

    .flow-step h4 {
      color: var(--color-primary);
      margin: 0 0 4px 0;
      font-size: 0.85em;
      font-weight: 600;
      text-shadow: var(--glow-accent);
    }

    .flow-step p {
      color: var(--color-text-muted);
      margin: 0;
      font-size: 0.75em;
      text-align: center;
      line-height: 1.3;
    }

    footer {
      background: var(--bg-header);
      padding: 20px 0;
      text-align: center;
      border-top: 2px solid var(--color-border-accent);
      margin-top: 20px;
      position: relative;
      backdrop-filter: blur(10px);
    }

    footer::before {
      content: '';
      position: absolute;
      top: -2px;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--color-primary), transparent);
      box-shadow: var(--glow-primary);
    }

    .footer-content {
      color: var(--color-text-muted);
      font-size: 0.8em;
    }

    .footer-content p {
      margin: 3px 0;
    }

    .github-link {
      display: inline-block;
      background: var(--color-primary);
      color: var(--bg-primary);
      padding: 8px 16px;
      text-decoration: none;
      border-radius: 6px;
      font-weight: 600;
      font-size: 0.85em;
      transition: all 0.3s ease;
      box-shadow: var(--glow-primary);
      border: 1px solid var(--color-primary);
    }

    .github-link:hover {
      background: var(--color-accent);
      color: var(--bg-primary);
      transform: translateY(-2px);
      box-shadow: var(--glow-accent);
    }

    @media (max-width: 768px) {
      header h1 {
        font-size: 2.5em;
        margin: 50px 0 0 0;
      }

      .hero-description {
        font-size: 1.2em;
      }

      .cta-button {
        padding: 15px 30px;
        font-size: 1.1em;
      }

      .data-flow {
        flex-direction: column;
      }

      .flow-arrow {
        transform: rotate(90deg);
      }

      .specs-list {
        grid-template-columns: 1fr;
      }

      .spec-item {
        flex-direction: column;
        align-items: flex-start;
        min-height: auto;
        padding: 20px;
      }

      .spec-label {
        margin-bottom: 8px;
        margin-right: 0;
        min-width: auto;
      }

      .spec-value {
        text-align: left;
        font-size: 1.1em;
      }
    }

    @media (max-width: 1200px) and (min-width: 769px) {
      .specs-list {
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      }

      .spec-label {
        min-width: 140px;
      }
    }

    /* Documentation Specific Styles */
    .ascii-diagram {
      background: var(--bg-tertiary);
      border-radius: 6px;
      margin: 8px 0;
      overflow-x: auto;
    }

    .ascii-diagram pre {
      margin: 0;
      padding: 10px;
      font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
      font-size: 0.7em;
      line-height: 1.25;
      color: var(--color-text-secondary);
      white-space: pre;
      overflow-x: auto;
    }

    .subsystem-docs ul {
      margin: 8px 0;
      padding-left: 15px;
    }

    .subsystem-docs li {
      margin: 4px 0;
      color: var(--color-text-secondary);
      line-height: 1.4;
      font-size: 0.8em;
    }

    .subsystem-docs ul ul {
      margin: 3px 0;
      padding-left: 12px;
    }

    .subsystem-docs ul ul li {
      margin: 2px 0;
      font-size: 0.95em;
      color: var(--color-text-muted);
    }

    .feature-updates h5, .hardware-history h5 {
      color: var(--color-primary);
      font-size: 0.9em;
      margin: 10px 0 5px 0;
      text-shadow: var(--glow-accent);
      border-bottom: 1px solid var(--color-border);
      padding-bottom: 3px;
    }

    .feature-updates ul, .hardware-history ul {
      margin: 5px 0 10px 0;
      padding-left: 15px;
    }

    .feature-updates li, .hardware-history li {
      margin: 3px 0;
      color: var(--color-text-secondary);
      line-height: 1.4;
      font-size: 0.8em;
    }

    /* API Documentation Styles */
    .api-endpoints {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin: 10px 0;
    }

    .api-endpoint {
      background: var(--bg-card);
      padding: 12px;
      border-radius: 8px;
      border-left: 3px solid var(--color-primary);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .api-endpoint h4 {
      margin: 0 0 4px 0;
      color: var(--color-primary);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9em;
      text-shadow: var(--glow-accent);
    }

    .api-endpoint p {
      margin: 4px 0;
      color: var(--color-text-secondary);
      font-size: 0.8em;
    }

    .api-details {
      margin-top: 8px;
    }

    .api-details h5 {
      color: var(--color-text-primary);
      font-size: 0.85em;
      margin: 8px 0 4px 0;
      font-weight: 600;
    }

    .api-details pre {
      background: var(--bg-tertiary);
      border: 1px solid var(--color-border);
      border-radius: 6px;
      padding: 8px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7em;
      line-height: 1.3;
      color: var(--color-text-secondary);
      overflow-x: auto;
      margin: 5px 0;
    }

    .api-details code {
      background: var(--bg-tertiary);
      padding: 1px 4px;
      border-radius: 3px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85em;
      color: var(--color-primary);
    }

    .python-api {
      margin-top: 10px;
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 8px;
    }

    .python-api > div {
      background: var(--bg-card);
      padding: 8px;
      border-radius: 6px;
      border-left: 2px solid var(--color-primary);
    }

    .python-api h4 {
      color: var(--color-primary);
      font-size: 0.85em;
      margin: 0 0 6px 0;
      border-bottom: 1px solid var(--color-border);
      padding-bottom: 4px;
      text-shadow: var(--glow-accent);
    }

    .python-api ul {
      margin: 4px 0;
      padding-left: 12px;
      font-size: 0.75em;
    }

    .python-api li {
      margin: 2px 0;
      color: var(--color-text-secondary);
      line-height: 1.3;
    }

    /* Hardware Diagrams Styles */
    .hardware-diagrams h3 {
      color: var(--color-primary);
      font-size: 1.4em;
      margin: 30px 0 20px 0;
      text-shadow: var(--glow-accent);
      border-bottom: 2px solid var(--color-border);
      padding-bottom: 10px;
    }

    .wiring-diagram h4, .power-diagram h4, .mechanical-diagram h4 {
      color: var(--color-text-primary);
      font-size: 1.1em;
      margin: 25px 0 15px 0;
      font-weight: 600;
    }

    /* Mobile responsiveness for new sections */
    @media (max-width: 768px) {
      .main-nav {
        gap: 12px;
        padding: 0 10px;
        flex-wrap: wrap;
      }

      .main-nav a {
        font-size: 0.8em;
        padding: 6px 8px;
      }
      
      .main-nav {
        gap: 8px;
      }

      .ascii-diagram pre {
        font-size: 0.75em;
        padding: 15px;
      }

      .api-endpoint {
        padding: 20px;
      }

      .api-details pre {
        font-size: 0.8em;
        padding: 12px;
      }

      .faq-item {
        padding: 20px;
      }

      .features-grid {
        grid-template-columns: 1fr;
      }
    }
    /* Theme Selector Styles */
    .theme-selector {
      display: inline-block;
      background: var(--gradient-card);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      box-shadow: var(--glow-primary), 0 4px 15px rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      width: 140px;
      overflow: visible;
    }

    .theme-selector:hover {
      box-shadow: var(--glow-accent), 0 6px 20px rgba(0, 0, 0, 0.5);
    }

    .theme-dropdown {
      position: relative;
      overflow: visible;
    }
    
    .theme-dropdown-btn {
      width: 100%;
      padding: 10px 12px;
      background: var(--bg-card);
      color: var(--color-text-primary);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.85em;
      font-weight: 500;
      text-align: left;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
    }
    
    .theme-dropdown-btn:hover {
      border-color: var(--color-primary);
      box-shadow: var(--glow-primary);
    }
    
    .theme-dropdown-arrow {
      font-size: 0.7em;
      transition: transform 0.3s ease;
      color: var(--color-primary);
    }
    
    .theme-dropdown.open .theme-dropdown-arrow {
      transform: rotate(180deg);
    }
    
    .theme-options {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: var(--bg-card);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      margin-top: 4px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
      z-index: 99999;
      overflow: visible;
      max-height: none;
      isolation: isolate;
    }
    
    .theme-dropdown.open .theme-options {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }
    
    .theme-button {
      width: 100%;
      padding: 8px 12px;
      border: none;
      background: transparent;
      color: #ffffff !important;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.85em;
      font-weight: 500;
      text-align: left;
      border-radius: 6px;
      margin: 2px 0;
    }
    
    .theme-button:first-child {
      border-radius: 8px 8px 6px 6px;
    }
    
    .theme-button:last-child {
      border-radius: 6px 6px 8px 8px;
    }
    
    .theme-button:hover {
      background: var(--bg-tertiary);
      color: #ffffff !important;
    }
    
    .theme-button.active {
      background: var(--color-primary);
      color: #000000;
      font-weight: 600;
    }
    
    @media (max-width: 768px) {
      header {
        padding: 60px 20px 40px 20px;
      }

      .header-nav {
        padding: 8px 0;
      }

      .theme-selector {
        width: 120px;
        padding: 8px;
      }

      .theme-options {
        min-width: 120px;
      }

      .theme-dropdown-btn {
        font-size: 0.8em;
        padding: 8px 10px;
      }

      .theme-button {
        font-size: 0.8em;
        padding: 6px 10px;
      }
    }

    /* Compaction Dropdown - DISABLED see Disabled_Features.md */
    .compaction-selector {
      display: none !important; /* DISABLED - see Disabled_Features.md */
      background: var(--gradient-card);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      box-shadow: var(--glow-primary), 0 4px 15px rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      width: 130px;
    }

    .compaction-dropdown {
      position: relative;
    }

    .compaction-dropdown-btn {
      width: 100%;
      padding: 8px 10px;
      background: var(--bg-card);
      color: var(--color-text-primary);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.8em;
      font-weight: 500;
      text-align: left;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
    }

    .compaction-dropdown-btn:hover {
      border-color: var(--color-primary);
      box-shadow: var(--glow-primary);
    }

    .compaction-dropdown-arrow {
      font-size: 0.7em;
      transition: transform 0.3s ease;
      color: var(--color-primary);
    }

    .compaction-dropdown.open .compaction-dropdown-arrow {
      transform: rotate(180deg);
    }

    .compaction-options {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: var(--gradient-card);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      margin-top: 4px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      z-index: 1000;
    }

    .compaction-dropdown.open .compaction-options {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .compaction-button {
      width: 100%;
      padding: 6px 10px;
      border: none;
      background: transparent;
      color: #ffffff !important;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.8em;
      font-weight: 500;
      text-align: left;
      border-radius: 6px;
      margin: 2px 0;
    }

    .compaction-button:hover {
      background: var(--bg-tertiary);
    }

    .compaction-button.active {
      background: var(--color-primary);
      color: #000000 !important;
      font-weight: 600;
    }

    /* Combined API & Hardware Row - 3 columns side by side */
    .api-hardware-row {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 20px;
      align-items: stretch;
    }

    .api-hardware-row > div {
      background: var(--bg-card);
      border-radius: 10px;
      padding: 15px;
      border: 1px solid var(--color-border);
      display: flex;
      flex-direction: column;
    }

    .api-hardware-row h3 {
      color: var(--color-primary);
      font-size: 1.1em;
      margin: 0 0 12px 0;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--color-border);
      flex-shrink: 0;
    }

    /* API Endpoints in single column within its box */
    .api-endpoints {
      display: flex;
      flex-direction: column;
      gap: 8px;
      flex: 1;
      overflow-y: auto;
    }

    /* Python API list styling */
    .python-api-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
      flex: 1;
      justify-content: space-between;
    }

    .python-api-list > div {
      background: var(--bg-tertiary);
      border-radius: 6px;
      padding: 10px;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .python-api-list h4 {
      color: var(--color-primary);
      font-size: 0.9em;
      margin: 0 0 8px 0;
    }

    .python-api-list ul {
      margin: 0;
      padding-left: 15px;
      flex: 1;
    }

    .python-api-list li {
      font-size: 0.85em;
      margin-bottom: 4px;
      color: var(--color-text-secondary);
    }

    .python-api-list code {
      color: var(--color-primary);
      font-family: 'JetBrains Mono', monospace;
    }

    /* Hardware diagrams in 2x2 grid within its box */
    .hardware-diagrams {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      align-items: stretch;
      flex: 1;
    }

    .hardware-diagrams > h3 {
      display: none;
    }

    .wiring-diagram,
    .power-diagram,
    .mechanical-diagram {
      background: var(--bg-card);
      border-radius: 8px;
      padding: 10px;
      border: 1px solid var(--color-border);
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .wiring-diagram h4,
    .power-diagram h4,
    .mechanical-diagram h4 {
      color: var(--color-primary);
      font-size: 0.85em;
      margin: 0 0 8px 0;
      padding-bottom: 5px;
      border-bottom: 1px solid var(--color-border);
    }

    /* Compact Mode (Default) */
    body.compact .api-endpoint {
      padding: 8px;
      border-radius: 6px;
    }

    body.compact .api-endpoint h4 {
      font-size: 0.8em;
      margin-bottom: 2px;
    }

    body.compact .api-endpoint p {
      font-size: 0.7em;
      margin: 2px 0;
    }

    body.compact .api-details {
      margin-top: 4px;
    }

    body.compact .api-details h5 {
      font-size: 0.75em;
      margin: 4px 0 2px 0;
    }

    body.compact .api-details pre {
      padding: 5px;
      font-size: 0.6em;
      line-height: 1.2;
      margin: 3px 0;
    }

    body.compact .api-details ul {
      margin: 3px 0;
      padding-left: 12px;
    }

    body.compact .api-details li {
      font-size: 0.7em;
      margin: 1px 0;
      line-height: 1.3;
    }

    body.compact .python-api {
      gap: 5px;
    }

    body.compact .python-api > div {
      padding: 5px;
    }

    body.compact .python-api h4 {
      font-size: 0.75em;
      margin: 0 0 3px 0;
      padding-bottom: 2px;
    }

    body.compact .python-api ul {
      font-size: 0.65em;
      padding-left: 10px;
    }

    body.compact .python-api li {
      margin: 1px 0;
    }

    body.compact .hardware-diagrams h3 {
      font-size: 0.9em;
      margin: 8px 0 5px 0;
      padding-bottom: 4px;
    }

    body.compact .wiring-diagram h4,
    body.compact .power-diagram h4,
    body.compact .mechanical-diagram h4 {
      font-size: 0.8em;
      margin: 6px 0 4px 0;
    }

    body.compact .ascii-diagram {
      margin: 4px 0;
    }

    body.compact .ascii-diagram pre {
      padding: 6px;
      font-size: 0.58em;
      line-height: 1.15;
    }

    body.compact h2 {
      font-size: 1.1em;
      margin-bottom: 8px;
    }

    body.compact h3 {
      font-size: 0.95em;
      margin-top: 10px;
      margin-bottom: 5px;
    }

    /* Normal Mode - single column layouts */
    body.normal .api-endpoints {
      grid-template-columns: 1fr;
    }

    body.normal .hardware-diagrams {
      grid-template-columns: 1fr;
    }

    body.normal .python-api {
      grid-template-columns: 1fr;
    }

    @media (max-width: 1400px) {
      .api-endpoints {
        grid-template-columns: repeat(2, 1fr);
      }
      .hardware-diagrams {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 1000px) {
      .api-endpoints {
        grid-template-columns: 1fr;
      }
      .python-api {
        grid-template-columns: 1fr 1fr;
      }
    }

    @media (max-width: 700px) {
      .python-api {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Navigation moved outside header to escape stacking context -->
  <div class="header-nav">
    <nav class="main-nav">
      <a href="#overview">Overview</a>
      <a href="#architecture">Architecture</a>
      <a href="#documentation">Documentation</a>
      <a href="#api">API</a>
      <a href="#hardware">Hardware</a>
      <a href="#usage">Usage</a>
      <!-- Compaction Selector -->
      <div class="compaction-selector">
        <div class="compaction-dropdown">
          <button class="compaction-dropdown-btn">
            <span class="compaction-current">Compact</span>
            <span class="compaction-dropdown-arrow">▼</span>
          </button>
          <div class="compaction-options">
            <div class="compaction-button active" data-compaction="compact">Compact</div>
            <div class="compaction-button" data-compaction="normal">Normal</div>
          </div>
        </div>
      </div>
      <!-- Theme Selector -->
      <div class="theme-selector">
        <div class="theme-dropdown">
          <button class="theme-dropdown-btn">
            <span class="theme-current">Dark Ocean</span>
            <span class="theme-dropdown-arrow">▼</span>
          </button>
          <div class="theme-options">
            <div class="theme-button active" data-theme="dark-ocean">Dark Ocean</div>
            <div class="theme-button" data-theme="night">Night</div>
            <div class="theme-button" data-theme="light-ocean">Light Ocean</div>
            <div class="theme-button" data-theme="nature">Nature</div>
            <div class="theme-button" data-theme="retro">Retro</div>
            <div class="theme-button" data-theme="futuristic">Futuristic</div>
          </div>
        </div>
      </div>
    </nav>
  </div>

  <header>
    <h1>TRITON</h1>
    <div class="subtitle">Autonomous Submarine Navigation System</div>
  </header>

  <section class="hero-section">
    <div class="container">
      <div class="hero-content">
        <p class="hero-description">
          A submarine navigation system that evolved from our CanSat project. 
          TRITON uses sensors and wireless data transmission to provide 
          underwater monitoring and navigation for autonomous submarine operations.
        </p>
        <a href="/dashboard" class="cta-button">Access Mission Control</a>
      </div>
    </div>
  </section>

  <div class="container">
    <section id="overview">
      <h2>Project Overview</h2>
      <p>
        TRITON evolved from our satellite simulation project into an autonomous 
        submarine navigation system. Built for real underwater operations, TRITON combines 
        environmental monitoring with motion sensors to provide submarine guidance and 
        data collection.
      </p>

      <div class="features-grid">
        <div class="feature-card">
          <h4>Environmental Monitoring</h4>
          <p>
            BME280 sensor reads temperature, humidity, pressure, and altitude. 
            Pressure readings calculate depth for underwater navigation, while environmental 
            data helps with mission planning and safety.
          </p>
        </div>

        <div class="feature-card">
          <h4>Inertial Navigation</h4>
          <p>
            MPU6050 motion sensor provides 6-axis sensing with accelerometer and 
            gyroscope. This gives real-time orientation tracking, motion detection, and navigation 
            support for submarine operations.
          </p>
        </div>

        <div class="feature-card">
          <h4>Wireless Communication</h4>
          <p>
            LoRa wireless modules enable data transmission between submarine and 
            surface station. Real-time sensor data streaming allows remote monitoring and mission control 
            from long distances.
          </p>
        </div>

        <div class="feature-card">
          <h4>Real-time Dashboard</h4>
          <p>
            Web-based mission control shows live sensor data, statistics,
            and logging. Chart.js provides interactive data
            visualization with zoom/pan controls for detailed analysis.
          </p>
        </div>

        <div class="feature-card">
          <h4>Multi-Metric Correlation</h4>
          <p>
            Dual Y-axis correlation view allows comparing different sensor metrics
            on a single chart. Visualize relationships between temperature and pressure,
            acceleration and rotation, or any combination of sensor data.
          </p>
        </div>

        <div class="feature-card">
          <h4>Mission Comparison</h4>
          <p>
            Compare data from multiple missions side-by-side with statistical analysis.
            Load archived CSV logs and overlay them with current live data to track
            performance changes and analyze trends across different runs.
          </p>
        </div>

        <div class="feature-card">
          <h4>Chart Export</h4>
          <p>
            Export individual charts or all visualizations as PNG or JPEG images.
            Download charts individually or as a ZIP archive for reports,
            documentation, and post-mission analysis presentations.
          </p>
        </div>

        <div class="feature-card">
          <h4>Time Range Filtering</h4>
          <p>
            Filter displayed data by time range with preset options (30s, 1min, 5min)
            or custom time windows. Apply filters to both chart display and data exports
            for focused analysis of specific mission phases.
          </p>
        </div>

        <div class="feature-card">
          <h4>Extended Statistics</h4>
          <p>
            Comprehensive statistical analysis including min, max, average, median,
            standard deviation, and percentiles (25%, 75%, 95%). Track data overview
            with total points, sample rate, time span, and real-time update status.
          </p>
        </div>

        <div class="feature-card">
          <h4>Data Logging</h4>
          <p>
            CSV logging with automatic archiving saves mission data. Threshold-based 
            transmission reduces network traffic while keeping important data for later analysis.
          </p>
        </div>

        <div class="feature-card">
          <h4>Autonomous Operation</h4>
          <p>
            Raspberry Pi-based sensor collection with intelligent error handling and graceful degradation.
            System continues operation even with partial sensor failures, ensuring mission continuity and data collection reliability.
          </p>
        </div>

        <div class="feature-card">
          <h4>Motor Control</h4>
          <p>
            Web-based brushless motor control via LoRa with throttle presets, slider control, and ramp testing.
            Hybrid transmission protocol ensures responsive motor control while maintaining sensor data reception
            over half-duplex LoRa.
          </p>
        </div>

        <div class="feature-card">
          <h4>ESC Integration</h4>
          <p>
            Hobbywing Quicrun WP10BL120 ESC with precise PWM control via pigpio.
            50Hz servo frequency with configurable pulse widths (1000-2000μs) and 75% safety throttle limit
            for reliable propulsion control.
          </p>
        </div>
      </div>
    </section>

    <section id="architecture" class="mission-overview">
      <div class="container">
        <h2>System Architecture</h2>
        <p>TRITON uses a two-part system with bidirectional LoRa communication for sensor data and motor control:</p>

        <div class="data-flow">
        <div class="flow-step">
          <h4>Raspberry Pi</h4>
          <p>Sensor collection<br>Motor/ESC control<br>LoRa TX/RX</p>
        </div>
        <div class="flow-arrow">⇄</div>
        <div class="flow-step">
          <h4>LoRa Network</h4>
          <p>Sensor data (Pi→PC)<br>Motor commands (PC→Pi)<br>Hybrid protocol</p>
        </div>
        <div class="flow-arrow">⇄</div>
        <div class="flow-step">
          <h4>PC Base Station</h4>
          <p>Data reception<br>Motor command TX<br>Web dashboard</p>
        </div>
        <div class="flow-arrow">→</div>
        <div class="flow-step">
          <h4>Mission Control</h4>
          <p>Live visualization<br>Motor control UI<br>Data export</p>
        </div>
        </div>
      </div>
    </section>

    <section>
      <h2>Technical Specifications</h2>
      <div class="tech-specs">
        <h3>Hardware Platform</h3>
        <div class="specs-list">
          <div class="spec-item">
            <span class="spec-label">Controller:</span>
            <span class="spec-value">Raspberry Pi Zero 2 W</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Environment:</span>
            <span class="spec-value">BME280 (I2C 0x76)</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">IMU:</span>
            <span class="spec-value">MPU6050 (I2C 0x68)</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Communication:</span>
            <span class="spec-value">LoRa 9600 baud</span>
          </div>
        </div>

        <h3>Sensor Capabilities</h3>
        <div class="specs-list">
          <div class="spec-item">
            <span class="spec-label">Temperature:</span>
            <span class="spec-value">±0.25°C resolution</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Pressure:</span>
            <span class="spec-value">±0.5 hPa threshold</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Acceleration:</span>
            <span class="spec-value">±16g range</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Gyroscope:</span>
            <span class="spec-value">±2000°/s range</span>
          </div>
        </div>

        <h3>Motor/ESC System</h3>
        <div class="specs-list">
          <div class="spec-item">
            <span class="spec-label">ESC:</span>
            <span class="spec-value">Hobbywing Quicrun WP10BL120</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">PWM Frequency:</span>
            <span class="spec-value">50Hz (servo standard)</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Pulse Range:</span>
            <span class="spec-value">1000-2000μs (neutral: 1500μs)</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">GPIO Pin:</span>
            <span class="spec-value">Pin 12 (GPIO18)</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Safety Limit:</span>
            <span class="spec-value">75% max throttle</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Control Mode:</span>
            <span class="spec-value">Hybrid TX (150ms/2s adaptive)</span>
          </div>
        </div>

        <h3>Data Management</h3>
        <div class="specs-list">
          <div class="spec-item">
            <span class="spec-label">Logging:</span>
            <span class="spec-value">CSV with MET timestamps</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Update Rate:</span>
            <span class="spec-value">~1 second intervals</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">History:</span>
            <span class="spec-value">300 data points per metric</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Web Interface:</span>
            <span class="spec-value">Port 5000, network accessible</span>
          </div>
        </div>
      </div>
    </section>

    <section id="documentation">
      <h2>Documentation</h2>
      <p>
        Documentation and resources for TRITON development, setup, and operation.
      </p>

      <div class="features-grid">
        <div class="feature-card">
          <h4>System Architecture Diagrams</h4>
          <div class="diagram-section">
            <h5>Two-Part System Architecture</h5>
            <div class="ascii-diagram">
              <pre>
┌─────────────────┐    LoRa     ┌─────────────────┐
│  Raspberry Pi   │◄═══════════►│   PC Station    │
│                 │  9600 baud  │                 │
├─────────────────┤  Bidirect.  ├─────────────────┤
│ BME280 Sensor   │             │ Data Reception  │
│ • Temperature   │  ────────►  │ • CSV Logging   │
│ • Humidity      │ Sensor Data │ • Statistics    │
│ • Pressure      │             │ • Web Dashboard │
├─────────────────┤             ├─────────────────┤
│ MPU6050 IMU     │             │ Motor Commands  │
│ • Accelerometer │  ◄────────  │ • Throttle TX   │
│ • Gyroscope     │ CMD:THROTTLE│ • Hybrid Mode   │
├─────────────────┤             ├─────────────────┤
│ Motor/ESC       │             │ Mission Control │
│ • PWM Control   │             │ • Motor UI      │
│ • 75% Max       │             │ • Ramp Test     │
└─────────────────┘             └─────────────────┘
              </pre>
            </div>
            <h5>Data Flow Architecture</h5>
            <div class="ascii-diagram">
              <pre>
Sensor Data → Threshold Check → LoRa Transmission
     ↓              ↓                    ↓
Local Cache → Data Validation → PC Reception
     ↓              ↓                    ↓
Error Handle → Retry Logic → CSV Logging → Web Dashboard
              </pre>
            </div>
          </div>
        </div>

        <div class="feature-card">
          <h4>Subsystem Documentation</h4>
          <div class="subsystem-docs">
            <h5>Sensor Subsystem</h5>
            <ul>
              <li><strong>BME280 Environmental Sensor</strong>
                <ul>
                  <li>I2C Address: 0x76</li>
                  <li>Sea level pressure calibration: 993.9 hPa</li>
                  <li>Temperature range: -40°C to +85°C</li>
                  <li>Pressure range: 300-1100 hPa</li>
                  <li>Humidity range: 0-100% RH</li>
                </ul>
              </li>
              <li><strong>MPU6050 Inertial Measurement Unit</strong>
                <ul>
                  <li>I2C Address: 0x68</li>
                  <li>Gyroscope range: ±2000°/s</li>
                  <li>Accelerometer range: ±16g</li>
                  <li>Built-in temperature sensor</li>
                  <li>Digital Motion Processor (DMP)</li>
                </ul>
              </li>
            </ul>

            <h5>Communication Subsystem</h5>
            <ul>
              <li><strong>LoRa Wireless</strong>
                <ul>
                  <li>Frequency: 915MHz (US) / 868MHz (EU)</li>
                  <li>Baud rate: 9600</li>
                  <li>Range: Up to 15km line of sight</li>
                  <li>Power consumption: <100mA</li>
                  <li>Serial interface: /dev/ttyUSB0 (Pi), COM8 (PC)</li>
                </ul>
              </li>
            </ul>

            <h5>Data Management Subsystem</h5>
            <ul>
              <li><strong>Logging System</strong>
                <ul>
                  <li>Format: CSV with MET timestamps</li>
                  <li>Directory: logs/sensor_data_YYYYMMDD_HHMMSS.csv</li>
                  <li>Archive: logs/previous_data/</li>
                  <li>Auto-rotation and cleanup</li>
                </ul>
              </li>
              <li><strong>Web Interface</strong>
                <ul>
                  <li>Flask server on port 5000</li>
                  <li>Chart.js visualization with zoom/pan</li>
                  <li>Real-time updates via AJAX</li>
                  <li>CSV download functionality</li>
                  <li>Time range filtering (presets + custom)</li>
                  <li>Multi-metric correlation charts</li>
                  <li>Mission comparison with overlays</li>
                  <li>Chart export (PNG/JPEG/ZIP)</li>
                  <li>Extended statistics dashboard</li>
                </ul>
              </li>
            </ul>
          </div>
        </div>

        <div class="feature-card">
          <h4>Software Feature Updates</h4>
          <div class="feature-updates">
            <h5>Version 2.2 - Current</h5>
            <ul>
              <li>Mission comparison with side-by-side data analysis</li>
              <li>Multi-metric correlation view with dual Y-axis</li>
              <li>Chart export functionality (PNG/JPEG/ZIP)</li>
              <li>Time range filtering for display and exports</li>
              <li>Extended statistics with percentiles and sample rate</li>
              <li>Interactive zoom/pan controls on all charts</li>
              <li>Filtered data CSV export</li>
            </ul>

            <h5>Version 2.1</h5>
            <ul>
              <li>Enhanced web dashboard with multi-theme support</li>
              <li>Real-time test data generation system</li>
              <li>Improved chart visualization with Chart.js</li>
              <li>Automatic folder opening for log management</li>
              <li>Theme persistence across sessions</li>
            </ul>

            <h5>Version 2.0 - Mission Control Update</h5>
            <ul>
              <li>Dual-platform architecture implementation</li>
              <li>LoRa communication integration</li>
              <li>Comprehensive error handling and graceful degradation</li>
              <li>Statistical analysis and threshold-based transmission</li>
              <li>CSV logging with automatic archiving</li>
            </ul>

            <h5>Version 1.x - CanSat Legacy</h5>
            <ul>
              <li>Initial sensor data collection</li>
              <li>Basic BME280 and MPU6050 integration</li>
              <li>Simple data logging capabilities</li>
              <li>Performance monitoring and optimization</li>
            </ul>
          </div>
        </div>

        <div class="feature-card">
          <h4>Hardware Upgrade History</h4>
          <div class="hardware-history">
            <h5>Generation 3 - Current TRITON</h5>
            <ul>
              <li><strong>Controller:</strong> Raspberry Pi Zero 2 W (upgrade from Pi Zero)</li>
              <li><strong>Wireless:</strong> LoRa modules with external antennas</li>
              <li><strong>Power:</strong> Optimized power management system</li>
              <li><strong>Enclosure:</strong> Waterproof submarine housing</li>
              <li><strong>Sensors:</strong> Calibrated BME280 and MPU6050</li>
            </ul>

            <h5>Generation 2 - Enhanced CanSat</h5>
            <ul>
              <li><strong>Controller:</strong> Raspberry Pi Zero W</li>
              <li><strong>Sensors:</strong> BME280 environmental sensor added</li>
              <li><strong>Storage:</strong> MicroSD card data logging</li>
              <li><strong>Communication:</strong> WiFi-based data transmission</li>
            </ul>

            <h5>Generation 1 - Original CanSat</h5>
            <ul>
              <li><strong>Controller:</strong> Arduino-based system</li>
              <li><strong>Sensors:</strong> Basic temperature and pressure sensors</li>
              <li><strong>Storage:</strong> EEPROM-based data storage</li>
              <li><strong>Communication:</strong> Radio frequency transmission</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <section id="api-hardware">
      <h2>API References and Hardware</h2>
      <div class="api-hardware-row">
        <div class="rest-api-column">
          <h3>REST API Endpoints</h3>
          <div class="api-endpoints">
          <div class="api-endpoint">
            <h4>GET /data</h4>
            <p><strong>Description:</strong> Retrieve current sensor data and historical measurements</p>
            <div class="api-details">
              <h5>Response Format:</h5>
              <pre><code>{
  "timestamp": "2025-08-31 18:30:45",
  "history": {
    "Elapsed [s]": [0.0, 1.2, 2.5, ...],
    "Temp_BME280 [°C]": [22.5, 22.7, 22.6, ...],
    "Hum [%]": [65.2, 65.0, 64.8, ...],
    "Press [hPa]": [1013.2, 1013.1, 1013.0, ...],
    "Alt [m]": [150.2, 150.5, 150.8, ...],
    "Acc x [m/s²]": [0.02, -0.01, 0.03, ...],
    "Acc y [m/s²]": [0.01, 0.02, -0.01, ...],
    "Acc z [m/s²]": [9.81, 9.82, 9.80, ...],
    "Gyro x [°/s]": [0.1, -0.2, 0.3, ...],
    "Gyro y [°/s]": [0.0, 0.1, -0.1, ...],
    "Gyro z [°/s]": [0.2, 0.0, 0.1, ...],
    "Temp_MPU [°C]": [23.1, 23.2, 23.0, ...]
  }
}</code></pre>
            </div>
          </div>

          <div class="api-endpoint">
            <h4>POST /update</h4>
            <p><strong>Description:</strong> Submit new sensor data from Raspberry Pi</p>
            <div class="api-details">
              <h5>Request Format:</h5>
              <pre><code>{
  "timestamp": "2025-08-31 18:30:45",
  "data": {
    "Elapsed [s]": 45.2,
    "Temp_BME280 [°C]": 22.5,
    "Hum [%]": 65.2,
    "Press [hPa]": 1013.2,
    "Alt [m]": 150.2,
    "Acc x [m/s²]": 0.02,
    "Acc y [m/s²]": 0.01,
    "Acc z [m/s²]": 9.81,
    "Gyro x [°/s]": 0.1,
    "Gyro y [°/s]": 0.0,
    "Gyro z [°/s]": 0.2,
    "Temp_MPU [°C]": 23.1
  }
}</code></pre>
              <h5>Response:</h5>
              <pre><code>{"status": "ok"}</code></pre>
            </div>
          </div>

          <div class="api-endpoint">
            <h4>GET /download/latest</h4>
            <p><strong>Description:</strong> Download the most recent CSV log file</p>
            <p><strong>Response:</strong> Binary CSV file download</p>
          </div>

          <div class="api-endpoint">
            <h4>GET /download/list</h4>
            <p><strong>Description:</strong> Get list of archived log files</p>
            <div class="api-details">
              <h5>Response:</h5>
              <pre><code>["sensor_data_20250831_183045.csv", "sensor_data_20250830_142030.csv", ...]</code></pre>
            </div>
          </div>

          <div class="api-endpoint">
            <h4>POST /generate_random_data</h4>
            <p><strong>Description:</strong> Generate test data for dashboard testing</p>
            <div class="api-details">
              <h5>Response:</h5>
              <pre><code>{"status": "success", "message": "Random data generated"}</code></pre>
            </div>
          </div>

          <div class="api-endpoint">
            <h4>POST /clear_test_data</h4>
            <p><strong>Description:</strong> Clear all test data from system</p>
            <div class="api-details">
              <h5>Response:</h5>
              <pre><code>{"status": "success", "message": "Test data cleared"}</code></pre>
            </div>
          </div>

          <div class="api-endpoint">
            <h4>GET /logs/list</h4>
            <p><strong>Description:</strong> Get list of all mission log files for comparison</p>
            <div class="api-details">
              <h5>Response Format:</h5>
              <pre><code>{
  "logs": [
    {
      "filename": "sensor_data_20251208_143022.csv",
      "path": "logs/sensor_data_20251208_143022.csv",
      "size": 15234,
      "modified": "2025-12-08 14:30:22"
    },
    ...
  ],
  "archived": [
    {
      "filename": "sensor_data_20251207_091522.csv",
      "path": "logs/previous_data/sensor_data_20251207_091522.csv",
      "size": 45678,
      "modified": "2025-12-07 09:15:22"
    },
    ...
  ]
}</code></pre>
            </div>
          </div>

          <div class="api-endpoint">
            <h4>GET /logs/&lt;filename&gt;</h4>
            <p><strong>Description:</strong> Load specific mission log file data for comparison</p>
            <div class="api-details">
              <h5>Response:</h5>
              <pre><code>{
  "filename": "sensor_data_20251208_143022.csv",
  "data": {
    "Elapsed [s]": [0.0, 1.2, 2.5, ...],
    "Temp_BME280 [°C]": [22.5, 22.7, 22.6, ...],
    ...
  },
  "stats": {
    "points": 1234,
    "duration": 4567.8
  }
}</code></pre>
            </div>
          </div>

          <div class="api-endpoint">
            <h4>POST /open_logs_folder</h4>
            <p><strong>Description:</strong> Open logs directory in system file explorer</p>
            <div class="api-details">
              <h5>Response:</h5>
              <pre><code>{"status": "success", "message": "Opened logs folder"}</code></pre>
            </div>
          </div>
          </div>
        </div>

        <div class="python-api-column">
          <h3>Python API Reference</h3>
          <div class="python-api-list">
            <div>
              <h4>Sensor Collection (test.py)</h4>
              <ul>
                <li><code>read_bme280()</code> - Environmental data</li>
                <li><code>read_mpu6050()</code> - IMU data</li>
                <li><code>send_lora_data()</code> - LoRa transmit</li>
                <li><code>update_web_dashboard()</code> - Web update</li>
              </ul>
            </div>
            <div>
              <h4>Data Reception (lorareceivertest.py)</h4>
              <ul>
                <li><code>receive_lora_data()</code> - LoRa receive</li>
                <li><code>parse_sensor_data()</code> - Parse data</li>
                <li><code>log_to_csv()</code> - CSV logging</li>
                <li><code>calculate_statistics()</code> - Stats</li>
              </ul>
            </div>
            <div>
              <h4>Web Server (app.py)</h4>
              <ul>
                <li><code>update_data_history()</code> - History buffer</li>
                <li><code>generate_chart_data()</code> - Chart.js data</li>
                <li><code>serve_log_files()</code> - File downloads</li>
                <li><code>cleanup_port()</code> - Port cleanup</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="hardware-column">
          <h3>Hardware Schematics</h3>
          <div class="hardware-diagrams">
        <div class="wiring-diagram" id="rpi-wiring">
          <h4>Raspberry Pi Wiring</h4>
          <div class="ascii-diagram"><pre>BME280 (I2C - 0x76)
Pi Pin 1 (3.3V) → VCC
Pi Pin 3 (SDA)  → SDA
Pi Pin 5 (SCL)  → SCL
Pi Pin 9 (GND)  → GND

MPU6050 (I2C - 0x68)
Pi Pin 1 (3.3V) → VCC
Pi Pin 3 (SDA)  → SDA
Pi Pin 5 (SCL)  → SCL
Pi Pin 9 (GND)  → GND

LoRa (UART - 9600)
Pi Pin 2 (5V)   → VCC
Pi Pin 6 (GND)  → GND
Pi Pin 8 (TXD)  → RXD
Pi Pin 10 (RXD) → TXD</pre></div>
        </div>

        <div class="wiring-diagram" id="pc-wiring">
          <h4>PC Station Wiring</h4>
          <div class="ascii-diagram"><pre>PC ──USB──┬── USB-Serial
          │   Adapter
          │   (FTDI/CP2102)
          │
          └── LoRa Module
              (Receiver)

Port: COM8 (Win)
      /dev/ttyUSB0 (Linux)
Baud: 9600</pre></div>
        </div>

        <div class="power-diagram">
          <h4>Power System</h4>
          <div class="ascii-diagram"><pre>Battery 7.4V Li-Po
    (2S 2200mAh)
         │
    Buck Conv 95%
    (7.4V → 5V)
         │
    ┌────┼────┬────┐
    │    │    │    │
   RPi BME  MPU LoRa
   5V  3.3V 3.3V 3.3V
  500mA 3mA 4mA 45mA

Total: ~550mA @ 5V
Life: ~4 hours</pre></div>
        </div>

        <div class="mechanical-diagram">
          <h4>Mechanical Assembly</h4>
          <div class="ascii-diagram"><pre>Submarine Enclosure
┌───────────────────┐
│ [RPi][BME][MPU]   │
│      [LoRa]       │
│                   │
│ [Battery 7.4V]    │
└───────────────────┘
200×100×60mm ABS
O-ring seals
Depth: 10m (1 ATM)</pre></div>
          </div>
          </div>
        </div>
      </div>
    </section>

    <section id="usage">
      <h2>Usage Guide</h2>
      <p>
        This section covers common questions about operating TRITON, from hardware setup to
        dashboard features and troubleshooting.
      </p>

      <div class="features-grid">
        <div class="feature-card">
          <h4>Sensor Configuration</h4>
          <p>
            TRITON uses a BME280 environmental sensor for temperature, humidity, pressure, and altitude readings,
            plus an MPU6050 motion sensor for acceleration and rotation data. Both connect via I2C to the Raspberry Pi.
            The BME280 requires sea level pressure calibration for accurate altitude readings - check a local weather
            site for current values. The motion sensor works out of the box but can be calibrated by placing it flat
            and still to establish baseline readings.
          </p>
        </div>

        <div class="feature-card">
          <h4>Communication Range</h4>
          <p>
            LoRa provides up to 15km range in open air. Underwater, range drops significantly to 50-100 meters
            depending on water clarity, depth, and antenna setup. For deeper operations, consider using a tethered
            buoy or surface float for the transmitter. The system continues logging data locally even without
            wireless connectivity - retrieve CSV files from the SD card after the mission.
          </p>
        </div>

        <div class="feature-card">
          <h4>Power Management</h4>
          <p>
            Expect approximately 4 hours of operation with a 2200mAh 7.4V battery running continuously.
            Extend battery life by adjusting transmission thresholds in <code>src/test.py</code> via the
            <code>should_transmit()</code> function. Lower thresholds increase transmission frequency
            (more battery usage), while higher thresholds reduce updates but conserve power. LoRa transmission
            consumes most of the power budget.
          </p>
        </div>

        <div class="feature-card">
          <h4>Error Handling</h4>
          <p>
            The system continues operating with whatever sensors remain functional. If the pressure sensor fails,
            depth information is lost but motion data continues. Complete sensor failure triggers retry logic
            with error logging. The dashboard displays "Sensor Error" for malfunctioning components, allowing
            operators to identify issues in real-time during missions.
          </p>
        </div>

        <div class="feature-card">
          <h4>Network Access</h4>
          <p>
            Access the dashboard from any device on the same network by navigating to
            <code>http://[PC-IP]:5000</code> in a browser. Find the host IP using <code>ipconfig</code> on Windows
            or <code>ifconfig</code> on Linux. For external network access, configure port forwarding on your
            router to expose port 5000. The dashboard works on any modern browser including mobile devices.
          </p>
        </div>

        <div class="feature-card">
          <h4>Sensor Troubleshooting</h4>
          <p>
            If sensors aren't responding, first verify I2C is enabled via <code>sudo raspi-config</code> under
            Interface Options. Check wiring: sensors require 3.3V power, ground, and SDA/SCL data lines.
            Run <code>i2cdetect -y 1</code> to verify the Pi detects the sensors - expect addresses 0x68 (MPU6050)
            and 0x76 (BME280). Missing addresses indicate wiring or power issues.
          </p>
        </div>
      </div>

      <h3>Dashboard Features</h3>
      <p>
        The mission control dashboard provides several analysis tools for monitoring and reviewing mission data.
      </p>

      <div class="features-grid">
        <div class="feature-card">
          <h4>Test Data Generation</h4>
          <p>
            Generate simulated sensor data for testing and demonstration without hardware connected.
            Start/stop data generation with adjustable speed from 0.5x to 10x (4 seconds to 0.2 seconds
            per update). Clear all test data instantly with the Clear Data button. Useful for testing
            dashboard functionality and demonstrating features.
          </p>
        </div>

        <div class="feature-card">
          <h4>Interactive Chart Controls</h4>
          <p>
            Every chart includes zoom and pan controls for detailed data inspection. Use +/− buttons
            to zoom in/out, arrow buttons to pan in any direction, or drag to select a zoom area.
            Click legend items to toggle individual data series visibility. Reset button restores
            the original view. Reset All Charts button available at the bottom of the MPU6050 section.
          </p>
        </div>

        <div class="feature-card">
          <h4>Real-time Sensor Charts</h4>
          <p>
            Live updating charts organized by sensor: BME280 section displays temperature, humidity,
            pressure, and altitude (4 charts). MPU6050 section shows acceleration X/Y/Z, gyroscope X/Y/Z,
            and temperature (7 charts). All charts update automatically as new data arrives with
            smooth animations and consistent styling across themes.
          </p>
        </div>

        <div class="feature-card">
          <h4>Time Range Filtering</h4>
          <p>
            Filter displayed data using the Time Range Filter section. Use preset buttons (30s, 1min, 5min)
            or enter custom start/end times for precise control. Display filters affect chart visualization
            while separate export filters in the download section allow exporting specific time windows.
            Info bar shows total points, filtered points, and current time range.
          </p>
        </div>

        <div class="feature-card">
          <h4>Correlation Analysis</h4>
          <p>
            The multi-metric correlation view plots two different sensor metrics on a single chart with
            dual Y-axes. This reveals relationships between measurements - temperature vs altitude,
            acceleration vs gyroscope, or any metric combination. Select metrics from the dropdowns and
            click "Update Chart" to generate the visualization. Useful for identifying sensor interdependencies.
          </p>
        </div>

        <div class="feature-card">
          <h4>Mission Comparison</h4>
          <p>
            Compare data from multiple missions by selecting archived CSV logs from the dropdown menus in the
            Mission Comparison section. Choose which metric to compare and view both missions overlaid on a
            single chart. Enable "Include Current Live Data" to add the active session. The statistics table
            displays min/max/average values for both missions with calculated differences.
          </p>
        </div>

        <div class="feature-card">
          <h4>Data Overview Statistics</h4>
          <p>
            The Statistics section displays key metrics at a glance: total data points collected, filtered
            points currently displayed, calculated sample rate in Hz, total time span of data, and timestamp
            of the last update. These cards provide instant insight into data collection status and
            help verify system performance during missions.
          </p>
        </div>

        <div class="feature-card">
          <h4>Extended Statistics Tables</h4>
          <p>
            Comprehensive statistics tables for both BME280 and MPU6050 sensors showing: minimum, maximum,
            average, median, standard deviation, and percentiles (25th, 75th, 95th) for each metric.
            Rate per second column shows data frequency. Tables update in real-time and respect
            current time range filters for focused analysis.
          </p>
        </div>

        <div class="feature-card">
          <h4>Log Management</h4>
          <p>
            Download the latest log file directly or select from archived logs via dropdown menu.
            Open Logs Folder button launches the system file explorer at the logs directory for
            direct file access. Logs are automatically archived to the previous_data folder and
            available for download or mission comparison analysis.
          </p>
        </div>

        <div class="feature-card">
          <h4>Filtered Data Export</h4>
          <p>
            Export CSV data with time-based filtering independent of display filters. Select preset
            time ranges (All, 30s, 1min, 5min) or specify custom start/end times. Export only the
            data you need for external analysis tools, spreadsheets, or archival purposes.
            Exported files maintain full precision of all sensor readings.
          </p>
        </div>

        <div class="feature-card">
          <h4>Chart Export</h4>
          <p>
            Export visualizations from the Download Logs section under "Export Charts as Images". Select which
            chart groups to include (BME280, MPU6050, Correlation), choose PNG or JPEG format, and download
            as individual files or a consolidated ZIP archive. Select All/Deselect All buttons for
            quick selection. Status indicator shows export progress.
          </p>
        </div>

        <div class="feature-card">
          <h4>Theme Selection</h4>
          <p>
            Three visual themes available via dropdown in the navigation bar: Dark Ocean (default blue
            theme), Night (amber/orange accents), and Light Ocean (bright blue for well-lit environments).
            Theme preference persists across sessions via localStorage. All charts and UI elements
            adapt colors automatically when switching themes.
          </p>
        </div>
      </div>

      <h3>Hardware Considerations</h3>
      <p>
        The sensors and electronics are not inherently waterproof. Submarine deployment requires a properly
        sealed enclosure with waterproof cable penetrations and O-ring seals. The pressure sensor tolerates
        some moisture but electronics require complete isolation. The reference enclosure design (200mm x 100mm
        x 60mm ABS plastic) provides 10 meter depth rating. Test in controlled environments like pools before
        open water deployment.
      </p>
    </section>

    <section>
      <div class="container">
        <h2>Mission Capabilities</h2>
        <p>
          TRITON is built for submarine operations with monitoring and navigation
          features. The system continuously monitors the environment for depth calculation through
          pressure readings, provides navigation data through accelerometer and gyroscope sensors, and
          transmits data wirelessly to the surface for monitoring and control.
        </p>

        <p>
          The two-part system ensures reliability. The Raspberry Pi
          handles sensor data collection and LoRa transmission, while the PC base station receives data,
          logs it, runs statistics, and hosts the web interface. This setup
          allows real-time monitoring of submarine operations from long distances while keeping
          detailed data logs for later analysis.
        </p>

        <p>
          The mission control dashboard provides comprehensive data analysis tools including
          multi-metric correlation views for understanding sensor relationships, mission comparison
          for analyzing performance across different runs, and chart export capabilities for
          documentation and reporting. Time range filtering and extended statistics help identify
          critical events and trends during mission review.
        </p>

        <div style="text-align: center; margin: 40px 0;">
          <a href="/dashboard" class="cta-button">Launch Mission Control Dashboard</a>
        </div>
      </div>
    </section>
  </div>

  <footer>
    <div class="container">
      <div class="footer-content">
        <p>TRITON Autonomous Submarine Navigation System</p>
        <p>Advanced sensor integration • Real-time data transmission • Mission control interface</p>
      </div>
    </div>
  </footer>

  <script>
    // Compaction Management System
    class CompactionManager {
      constructor() {
        this.currentCompaction = localStorage.getItem('triton-compaction') || 'compact';
        this.dropdown = null;
        this.dropdownBtn = null;
        this.currentSpan = null;
        this.init();
      }

      init() {
        this.dropdown = document.querySelector('.compaction-dropdown');
        this.dropdownBtn = document.querySelector('.compaction-dropdown-btn');
        this.currentSpan = document.querySelector('.compaction-current');

        this.applyCompaction(this.currentCompaction);
        this.setupEventListeners();
        this.updateActiveButton();
      }

      applyCompaction(level) {
        // Remove all compaction classes
        document.body.classList.remove('compact', 'normal');
        // Add the selected one
        document.body.classList.add(level);
        this.currentCompaction = level;
        localStorage.setItem('triton-compaction', level);

        // Update dropdown button text
        if (this.currentSpan) {
          const levelNames = {
            'compact': 'Compact',
            'normal': 'Normal'
          };
          this.currentSpan.textContent = levelNames[level] || level;
        }
      }

      setupEventListeners() {
        // Dropdown toggle
        if (this.dropdownBtn) {
          this.dropdownBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            this.dropdown.classList.toggle('open');
            // Close theme dropdown if open
            const themeDropdown = document.querySelector('.theme-dropdown');
            if (themeDropdown) themeDropdown.classList.remove('open');
          });
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', () => {
          if (this.dropdown) {
            this.dropdown.classList.remove('open');
          }
        });

        // Compaction option clicks
        const compactionOptions = document.querySelectorAll('.compaction-button');
        compactionOptions.forEach(option => {
          option.addEventListener('click', (e) => {
            e.stopPropagation();
            const level = option.getAttribute('data-compaction');
            this.applyCompaction(level);
            this.updateActiveButton();
            this.dropdown.classList.remove('open');
          });
        });
      }

      updateActiveButton() {
        const compactionOptions = document.querySelectorAll('.compaction-button');
        compactionOptions.forEach(option => {
          option.classList.remove('active');
          if (option.getAttribute('data-compaction') === this.currentCompaction) {
            option.classList.add('active');
          }
        });
      }
    }

    // Theme Management System
    class ThemeManager {
      constructor() {
        this.currentTheme = localStorage.getItem('triton-theme') || 'dark-ocean';
        this.dropdown = null;
        this.dropdownBtn = null;
        this.currentSpan = null;
        this.init();
      }
      
      init() {
        this.dropdown = document.querySelector('.theme-dropdown');
        this.dropdownBtn = document.querySelector('.theme-dropdown-btn');
        this.currentSpan = document.querySelector('.theme-current');
        
        this.applyTheme(this.currentTheme);
        this.setupEventListeners();
        this.updateActiveButton();
      }
      
      applyTheme(themeName) {
        document.documentElement.setAttribute('data-theme', themeName);
        this.currentTheme = themeName;
        localStorage.setItem('triton-theme', themeName);
        
        // Update dropdown button text
        if (this.currentSpan) {
          const themeNames = {
            'dark-ocean': 'Dark Ocean',
            'night': 'Night',
            'light-ocean': 'Light Ocean',
            'nature': 'Nature',
            'retro': 'Retro',
            'futuristic': 'Futuristic'
          };
          this.currentSpan.textContent = themeNames[themeName] || themeName;
        }
      }
      
      setupEventListeners() {
        // Dropdown toggle
        if (this.dropdownBtn) {
          this.dropdownBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            this.dropdown.classList.toggle('open');
            // Close compaction dropdown if open
            const compactionDropdown = document.querySelector('.compaction-dropdown');
            if (compactionDropdown) compactionDropdown.classList.remove('open');
          });
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', () => {
          if (this.dropdown) {
            this.dropdown.classList.remove('open');
          }
        });
        
        // Theme option clicks
        const themeOptions = document.querySelectorAll('.theme-button');
        themeOptions.forEach(option => {
          option.addEventListener('click', (e) => {
            e.stopPropagation();
            const theme = option.getAttribute('data-theme');
            this.applyTheme(theme);
            this.updateActiveButton();
            this.dropdown.classList.remove('open');
            
            // Add visual feedback
            option.style.transform = 'scale(0.95)';
            setTimeout(() => {
              option.style.transform = '';
            }, 150);
          });
        });
      }
      
      updateActiveButton() {
        const themeOptions = document.querySelectorAll('.theme-button');
        themeOptions.forEach(option => {
          option.classList.remove('active');
          if (option.getAttribute('data-theme') === this.currentTheme) {
            option.classList.add('active');
          }
        });
      }
    }
    
    // Sticky Navigation Handler
    class StickyNavHandler {
      constructor() {
        this.headerNav = document.querySelector('.header-nav');
        this.init();
      }
      
      init() {
        if (this.headerNav) {
          // Ensure nav is visible on page load
          this.headerNav.style.display = 'block';
          this.headerNav.style.visibility = 'visible';
          
          window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
              this.headerNav.classList.add('scrolled');
            } else {
              this.headerNav.classList.remove('scrolled');
            }
            // Debug: log scroll position
            console.log('Scroll position:', window.scrollY, 'Nav visible:', this.headerNav.style.visibility);
          });
        } else {
          console.error('Header navigation not found!');
        }
      }
    }
    
    // Initialize compaction, theme management and sticky nav when page loads
    document.addEventListener('DOMContentLoaded', () => {
      new CompactionManager();
      new ThemeManager();
      new StickyNavHandler();
    });
    
    // Smooth scrolling for anchor links with offset for fixed header
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          const headerHeight = 70; // Account for fixed header
          const targetPosition = target.offsetTop - headerHeight;
          
          window.scrollTo({
            top: targetPosition,
            behavior: 'smooth'
          });
        }
      });
    });
    
    // Add subtle parallax effect to hero section
    window.addEventListener('scroll', () => {
      const scrolled = window.pageYOffset;
      const heroSection = document.querySelector('.hero-section');
      if (heroSection) {
        heroSection.style.transform = `translateY(${scrolled * 0.1}px)`;
      }
    });
    
    // Add entrance animations for feature cards
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';
        }
      });
    }, observerOptions);
    
    document.addEventListener('DOMContentLoaded', () => {
      const cards = document.querySelectorAll('.feature-card, .flow-step, .spec-item');
      cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        card.style.transition = `opacity 0.6s ease ${index * 0.1}s, transform 0.6s ease ${index * 0.1}s`;
        observer.observe(card);
      });
    });
  </script>
</body>
</html>